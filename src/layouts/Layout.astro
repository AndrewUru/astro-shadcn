---
import { Sidebar } from "@/components/Sidebar";
import { MyThread } from "../components/ChatThread";
import "../styles/global.css";
import { LayoutInit } from "@/components/LayoutInit";

interface Props {
  title: string;
  description?: string;
  children: any;
}

const navigation = [
  { title: "Home", path: "/", icon: "Home" },
  { title: "Chat", path: "/chat", icon: "Chat" },
  { title: "README", path: "/readme", icon: "FileText" },
  { title: "MIT License", path: "/mit-license", icon: "Scale" }
];

const { 
  title,
  description = "A beautiful dashboard built with Astro and shadcn/ui"
} = Astro.props;

const preconnectUrls = [
  'https://fonts.googleapis.com',
  'https://fonts.gstatic.com'
];

const hideChatPaths = ['/chat'];
const currentPath = Astro.url.pathname;
const showChatAssistant = !hideChatPaths.includes(currentPath);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="description" content={description} />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="preconnect" href="/" crossorigin="anonymous">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    
    {preconnectUrls.map(url => (
      <link rel="preconnect" href={url} crossorigin="anonymous" />
    ))}
    
    <title>{title}</title>

    <script is:inline>
      const theme = localStorage.getItem('theme') || 
        (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      document.documentElement.classList[theme === 'dark' ? 'add' : 'remove']('dark');
    </script>
  </head>
  <body class="min-h-screen bg-background font-sans antialiased">
    <div class="flex h-screen optimize-gpu">
      <div id="left-sidebar" class="w-[80px] shrink-0 border-r transition-all">
        <Sidebar navigation={navigation} client:load /> 
      </div>
      
      <div class="flex-1 flex flex-col min-w-0">
        <header id="top-header" class="h-16 border-b flex items-center px-6 gap-4">
          <button id="toggle-left" class="p-2 hover:bg-accent rounded-lg">≡</button>
        </header>
        
        <main class="flex-1 overflow-auto p-6">
          <slot />
        </main>
        
        <footer id="bottom-footer" class="h-12 border-t flex items-center px-6 text-sm text-muted-foreground">
          © 2025 Your Company Name
        </footer>
      </div>
      
      <div id="right-panel" class="border-l flex flex-col transition-all w-[400px]">
        <div class="p-4 flex justify-end gap-2 border-b">
          <button id="right-full" class="p-2 hover:bg-accent rounded-lg">⬜</button>
          <button id="right-half" class="p-2 hover:bg-accent rounded-lg">½</button>
          <button id="right-quarter" class="p-2 hover:bg-accent rounded-lg">❏</button>
          <button id="right-close" class="p-2 hover:bg-accent rounded-lg">✕</button>
        </div>
        <MyThread client:load />

      </div>
    </div>

    <LayoutInit client:load />
